{% extends 'base.html' %}
{% block title %}Manage Candidates{% endblock %}
{% block content %}

<style>
    .view-switcher {
        text-align: right;
        margin-bottom: 16px;
    }
    .view-switcher button {
        background-color: #fff;
        border: 1px solid #eaeaea;
        color: #333;
        padding: 6px 14px;
        border-radius: 6px;
        margin-left: 6px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 15px;
        font-weight: 500;
        box-shadow: 0 2px 6px rgba(0,0,0,0.03);
    }
    .view-switcher button.active {
        background-color: #f2f2f2;
        color: #007bff;
        border-color: #007bff;
        box-shadow: 0 2px 8px rgba(0,123,255,0.08);
    }
    .table-container {
        padding: 24px;
        background-color: #ffffff;
        border-radius: 12px;
        margin-top: 24px;
    }
    h2 {
        text-align: center;
        font-size: 25px;
        margin-bottom: 20px;
    }
    .table {
        width: 100%;
        border-collapse: collapse;
        background: #fff;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 2px 6px rgba(0,0,0,0.04);
    }
    .table th, .table td {
        padding: 14px 18px;
        border-bottom: 1px solid #eaeaea;
        vertical-align: top;
        position: relative;
        font-size: 15px;
    }
    .table thead th {
        background-color: #f9f9f9;
        font-weight: 600;
        color: #333;
    }
    .table tbody tr:last-child td {
        border-bottom: none;
    }
    .btn-view {
        background-color: #ffffff;
        border: 1px solid #cccccc;
        color: #007bff;
        border-radius: 6px;
        padding: 8px 16px;
        text-decoration: none;
        transition: all 0.2s ease-in-out;
        font-size: 14px;
        margin-right: 6px;
        display: inline-block;
    }
    .btn-view:hover {
        background-color: #f2f2f2;
        border-color: #007bff;
        color: #0056b3;
    }
    .onboarding-status {
        font-size: 13px;
        color: #388e3c;
        margin-top: 4px;
        display: block;
    }
    .text-muted {
        color: #aaaaaa;
        font-size: 13px;
    }
    /* Card view styles */
    .candidate-cards {
        display: none;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 24px;
        flex-direction: row;
    }
    .candidate-card {
        flex: 1 1 calc(33.333% - 20px);
        background-color: #f9f9f9;
        padding: 18px;
        border-radius: 12px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
    .candidate-card h3 {
        font-size: 18px;
        margin-bottom: 10px;
    }
    .candidate-card p {
        font-size: 14px;
        margin: 4px 0;
    }
    .candidate-card-actions {
        margin-top: 12px;
        display: flex;
        justify-content: flex-start;
        gap: 12px;
        align-items: center;
    }
</style>

<div class="table-container">
    <div class="view-switcher">
        <a href="{{ url_for('manage_candidates', view='table') }}" class="view-btn{% if view == 'table' %} active{% endif %}">Table View</a>
        <a href="{{ url_for('manage_candidates', view='card') }}" class="view-btn{% if view == 'card' %} active{% endif %}">Card View</a>
    </div>

    <h2>Manage Candidates</h2>

    {% if view == 'card' %}
    <!-- Card View -->
    <div class="candidate-cards" style="display: flex; flex-wrap: wrap; gap: 20px; margin-top: 24px; flex-direction: row;">
        {% if candidates_list|length == 0 %}
            <div style="text-align:center; color:#aaa; padding:32px; width:100%;">No candidates found.</div>
        {% else %}
        {% for candidate in candidates_list %}
        <div class="candidate-card">
            <div>
                <h3>{{ candidate.name }}</h3>
                <p><strong>Position:</strong> {{ candidate.position }}</p>
                <p><strong>Status:</strong> {{ 'Resigned' if candidate.status == 'Resigned' else 'Fired' if candidate.status == 'Fired' else candidate.status }}</p>
                {% if candidate.status == 'Hired' and candidate.onboarding %}
                    <p class="onboarding-status">Onboarding: {{ candidate.onboarding_progress }}/{{ candidate.onboarding_total }} steps completed</p>
                {% endif %}
            </div>
            <div class="candidate-card-actions">
                <a href="{{ url_for('candidate_profile', candidate_id=candidate.id) }}" class="btn-view">View</a>
            </div>
        </div>
        {% endfor %}
        {% endif %}
    </div>
    {% else %}
    <!-- Table View -->
    <table class="table">
        <thead>
            <tr>
                <th>Candidate Name</th>
                <th>Position</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for candidate in candidates_list %}
            <tr>
                <td>{{ candidate.name }}</td>
                <td>{{ candidate.position }}</td>
                <td>
                    {{ 'Resigned' if candidate.status == 'Resigned' else 'Fired' if candidate.status == 'Fired' else candidate.status }}
                    {% if candidate.status == 'Hired' and candidate.onboarding %}
                        <span class="onboarding-status">Onboarding: {{ candidate.onboarding_progress }}/{{ candidate.onboarding_total }} steps completed</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{{ url_for('candidate_profile', candidate_id=candidate.id) }}" class="btn-view">View</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4" class="text-muted">No candidates found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
</div>

<style>
    .view-btn {
        background-color: #fff;
        border: 1px solid #eaeaea;
        color: #333;
        padding: 6px 14px;
        border-radius: 6px;
        margin-left: 6px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 15px;
        font-weight: 500;
        box-shadow: 0 2px 6px rgba(0,0,0,0.03);
        text-decoration: none;
        display: inline-block;
    }
    .view-btn.active {
        background-color: #f2f2f2;
        color: #007bff;
        border-color: #007bff;
        box-shadow: 0 2px 8px rgba(0,123,255,0.08);
    }
</style>

{% endblock %}
