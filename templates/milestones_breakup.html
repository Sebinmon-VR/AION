{% block content %}
<div style="max-width:900px;margin:40px auto;padding:32px 24px;background:#fff;border-radius:10px;box-shadow:0 2px 12px #0001;">
  <h2 style="color:#1976d2;">Milestone: {{ label|capitalize }}</h2>
  
  Quick Navigation for Hired Candidates
  {% if label|lower == 'hiring_success_rate' %}
  <!-- <div style="background:#e8f5e8;padding:16px;border-radius:8px;margin-bottom:20px;text-align:center;">
    <h3 style="color:#2e7d32;margin-bottom:12px;">ðŸ“Š Hiring Success Rate Analytics</h3>
    <div style="display:flex;gap:20px;justify-content:center;margin-bottom:12px;">
      <div style="background:white;padding:10px;border-radius:5px;border:2px solid #43a047;">
        <strong>Total Hired: {{ total_hired|default(0) }}</strong>
      </div>
      <div style="background:white;padding:10px;border-radius:5px;border:2px solid #1976d2;">
        <strong>Success Rate: {{ success_rate|default(0) }}%</strong>
      </div>
    </div>
    <a href="/milestones_breakup/hired" style="background:#43a047;color:white;padding:12px 24px;border-radius:6px;text-decoration:none;font-weight:bold;display:inline-block;">
      ðŸ“‹ View Detailed Hired Candidates Page
    </a>
  </div> -->
  
  <!-- Hiring Success Rate Chart Section -->
  <div style="display:flex;flex-wrap:wrap;gap:32px;justify-content:center;align-items:flex-start;margin-top:24px;">
    <div style="flex:1;min-width:320px;max-width:420px;text-align:center;">
      <h3 style="color:#1976d2;font-size:1.05rem;margin-bottom:8px;">Hiring Success Rate Breakdown</h3>
      <canvas id="successRateChart" width="320" height="320"></canvas>
      <div style="margin-top:12px;">
        <span style="font-size:1.1rem;">Total Applicants: <b id="totalApplicantsDisplay">{{ total_applicants|default(0) }}</b></span><br>
        <span style="font-size:1.1rem;">Total Hired: <b id="totalHiredDisplay">{{ total_hired|default(0) }}</b></span><br>
        <span style="font-size:1.1rem;">Success Rate: <b id="successRateDisplay">{{ success_rate|default(0) }}%</b></span>
      </div>
    </div>
    <div style="flex:1;min-width:320px;max-width:420px;text-align:center;">
      <h3 style="color:#1976d2;font-size:1.05rem;margin-bottom:8px;">Hired Candidates by Department</h3>
      <canvas id="deptSuccessChart" width="340" height="320"></canvas>
      <div id="deptSuccessHint" style="color:#888;font-size:0.98rem;margin-top:8px;">Click a department label to view hired candidates</div>
    </div>
  </div>
  {% elif label|lower == 'hired' %}
  <div style="display:flex;flex-wrap:wrap;gap:32px;justify-content:center;align-items:flex-start;">
    <div style="flex:1;min-width:320px;max-width:420px;text-align:center;">
      <h3 style="color:#1976d2;font-size:1.05rem;margin-bottom:8px;">Hiring Milestone Analytics</h3>
      <canvas id="triangleChart" width="320" height="320"></canvas>
      <div style="margin-top:12px;">
        <span style="font-size:1.1rem;">Total Applicants: <b id="totalApplicantsVal">{{ total_applicants }}</b></span><br>
        <span style="font-size:1.1rem;">Total Hired: <b id="totalHiredVal">{{ total_hired }}</b></span><br>
        <span style="font-size:1.1rem;">Success Rate: <b id="successRateVal">{{ success_rate }}%</b></span>
      </div>
    </div>
    <div style="flex:1;min-width:320px;max-width:420px;text-align:center;">
      <h3 style="color:#1976d2;font-size:1.05rem;margin-bottom:8px;">Department-wise Applicants</h3>
      <canvas id="deptRadarChart" width="340" height="320"></canvas>
      <div id="deptClickHint" style="color:#888;font-size:0.98rem;margin-top:8px;">Click a department label to view applicants</div>
    </div>
  </div>
  {% elif label|lower == 'total_vacancies' %}
  <div style="display:flex;flex-wrap:wrap;gap:32px;justify-content:center;align-items:flex-start;">
    <div style="flex:1;min-width:320px;max-width:420px;text-align:center;">
      <h3 style="color:#1976d2;font-size:1.05rem;margin-bottom:8px;">Vacancy Status Breakdown</h3>
      <canvas id="vacancyStatusChart" width="320" height="320"></canvas>
      <div style="margin-top:12px;">
        <span style="font-size:1.1rem;">Open: <b id="openVacanciesVal" style="color:#43a047;">{{ open_vacancies }}</b></span><br>
        <span style="font-size:1.1rem;">Closed: <b id="closedVacanciesVal" style="color:#f44336;">{{ closed_vacancies }}</b></span><br>
        <span style="font-size:1.1rem;">Total Jobs: <b id="totalJobsVal" style="color:#1976d2;">{{ total_jobs }}</b></span>
      </div>
    </div>
    <div style="flex:1;min-width:320px;max-width:420px;text-align:center;">
      <h3 style="color:#1976d2;font-size:1.05rem;margin-bottom:8px;">Department-wise Vacancies</h3>
      <canvas id="deptRadarChart" width="340" height="320"></canvas>
      <div id="deptClickHint" style="color:#888;font-size:0.98rem;margin-top:8px;">Click a department label to view jobs</div>
    </div>
  </div>
  {% elif label|lower == 'hiring_pace' %}
  <div style="margin:20px auto 0 auto; max-width:800px;">
    <h3 style="color:#1976d2;font-size:1.2rem;margin-bottom:16px;text-align:center;">Hiring Pace Analysis</h3>
    <p style="text-align:center;color:#666;margin-bottom:24px;">
      Evaluates hiring efficiency based on job posting duration, stages completed, and process speed.
    </p>
    
    {% if hiring_pace_details %}
    <div style="overflow-x:auto;">
      <table style="width:100%;border-collapse:collapse;background:#f9f9fc;margin-bottom:20px;">
        <thead>
          <tr style="background:#e3eaf7;color:#1976d2;">
            <th style="padding:12px 8px;text-align:left;">Job Title</th>
            <th style="padding:12px 8px;text-align:left;">Department</th>
            <th style="padding:12px 8px;text-align:center;">Posted Date</th>
            <th style="padding:12px 8px;text-align:center;">Weeks Elapsed</th>
            <th style="padding:12px 8px;text-align:center;">Stages Completed</th>
            <th style="padding:12px 8px;text-align:center;">Applicants</th>
            <th style="padding:12px 8px;text-align:center;">Current Status</th>
            <th style="padding:12px 8px;text-align:center;">Pace</th>
          </tr>
        </thead>
        <tbody>
          {% for job in hiring_pace_details %}
          <tr style="border-bottom:1px solid #ddd;">
            <td style="padding:10px 8px;">{{ job.job_title }}</td>
            <td style="padding:10px 8px;">{{ job.department }}</td>
            <td style="padding:10px 8px;text-align:center;">{{ job.posted_at }}</td>
            <td style="padding:10px 8px;text-align:center;">{{ job.weeks_elapsed }}</td>
            <td style="padding:10px 8px;text-align:center;">{{ job.stages_completed }}/5</td>
            <td style="padding:10px 8px;text-align:center;">{{ job.applicants_count }}</td>
            <td style="padding:10px 8px;text-align:center;">{{ job.candidate_status }}</td>
            <td style="padding:10px 8px;text-align:center;">
              <span class="pace-badge pace-{{ job.pace|lower }}" style="padding:4px 8px;border-radius:4px;font-weight:600;color:white;">
                {{ job.pace }}
              </span>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    
    <div style="background:#f5f5f5;padding:16px;border-radius:8px;margin-top:20px;">
      <h4 style="color:#1976d2;margin-bottom:12px;">Hiring Process Stages</h4>
      <div style="display:flex;flex-wrap:wrap;gap:16px;justify-content:space-between;">
        <div style="text-align:center;min-width:100px;">
          <div style="background:#1976d2;color:white;padding:8px;border-radius:4px;margin-bottom:4px;">Stage 1</div>
          <div style="font-size:0.9rem;">Application</div>
        </div>
        <div style="text-align:center;min-width:100px;">
          <div style="background:#1976d2;color:white;padding:8px;border-radius:4px;margin-bottom:4px;">Stage 2</div>
          <div style="font-size:0.9rem;">Interview</div>
        </div>
        <div style="text-align:center;min-width:100px;">
          <div style="background:#1976d2;color:white;padding:8px;border-radius:4px;margin-bottom:4px;">Stage 3</div>
          <div style="font-size:0.9rem;">Approval</div>
        </div>
        <div style="text-align:center;min-width:100px;">
          <div style="background:#1976d2;color:white;padding:8px;border-radius:4px;margin-bottom:4px;">Stage 4</div>
          <div style="font-size:0.9rem;">Hiring</div>
        </div>
        <div style="text-align:center;min-width:100px;">
          <div style="background:#1976d2;color:white;padding:8px;border-radius:4px;margin-bottom:4px;">Stage 5</div>
          <div style="font-size:0.9rem;">Onboarding</div>
        </div>
      </div>
    </div>
    
    <div style="background:#e8f5e8;padding:16px;border-radius:8px;margin-top:16px;">
      <h4 style="color:#2e7d32;margin-bottom:12px;">Pace Evaluation Criteria</h4>
      <ul style="margin:0;padding-left:20px;">
        <li><strong>Good:</strong> Meeting or exceeding expected timelines for each stage</li>
        <li><strong>Adequate:</strong> Slightly behind but within acceptable range</li>
        <li><strong>Inadequate:</strong> Significantly delayed, requires attention</li>
      </ul>
    </div>
    {% else %}
    <div style="text-align:center;color:#666;padding:40px;">
      <p>No active job postings to evaluate hiring pace.</p>
    </div>
    {% endif %}
  </div>
  {% else %}
  <!-- Only show general department radar chart for pages that don't have specific chart sections -->
  {% if label|lower not in ['hiring_success_rate'] %}
  <div style="margin:32px auto 0 auto; max-width:500px; text-align:center;">
    <canvas id="deptRadarChart" width="340" height="320"></canvas>
    <div id="deptClickHint" style="color:#888;font-size:0.98rem;margin-top:8px;">Click a department label to view applicants</div>
  </div>
  {% endif %}
  {% endif %}
  <div id="deptApplicantsTableWrapper" style="margin:28px auto 0 auto; max-width:700px; display:none;">
    <h4 id="deptApplicantsTitle" style="color:#1976d2;margin-bottom:10px;"></h4>
    <table id="deptApplicantsTable" style="width:100%;border-collapse:collapse;background:#f9f9fc;">
      <thead>
        <tr style="background:#e3eaf7;color:#1976d2;">
          {% if label|lower == 'total_vacancies' %}
          <th style="padding:8px 6px;">Job Title</th>
          <th style="padding:8px 6px;">Department</th>
          <th style="padding:8px 6px;">Status</th>
          <th style="padding:8px 6px;">Posted Date</th>
          <th style="padding:8px 6px;">Openings</th>
          {% else %}
          <th style="padding:8px 6px;">Name</th>
          <th style="padding:8px 6px;">Job Title</th>
          <th style="padding:8px 6px;">Status</th>
          <th style="padding:8px 6px;">Applied Date</th>
          <th style="padding:8px 6px;">Action</th>
          {% endif %}
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Global variables for all chart types
    let allCandidates = [];
    
    // Polar area chart for Hiring Milestone Analytics (only for hired)
    {% if label|lower == 'hired' %}
    window.addEventListener('DOMContentLoaded', function() {
      const polarData = [
        Number({{ total_applicants|default(0) }}),
        Number({{ total_hired|default(0) }}),
        Number({{ success_rate|replace('%','')|default(0) }})
      ];
      const polarLabels = ['Total Applicants', 'Total Hired', 'Success Rate'];
      const polarColors = [
        'rgba(25, 118, 210, 0.7)',
        'rgba(0, 200, 83, 0.7)',
        'rgba(255, 193, 7, 0.7)'
      ];
      const polarBorderColors = [
        '#1976d2',
        '#00c853',
        '#ffc107'
      ];
      const triangleCanvas = document.getElementById('triangleChart');
      if (triangleCanvas) {
        const triangleCtx = triangleCanvas.getContext('2d');
        new Chart(triangleCtx, {
          type: 'polarArea',
          data: {
            labels: polarLabels,
            datasets: [{
              data: polarData,
              backgroundColor: polarColors,
              borderColor: polarBorderColors,
              borderWidth: 2
            }]
          },
          options: {
            responsive: false,
            plugins: {
              legend: {
                display: true,
                position: 'bottom',
                labels: {
                  color: '#222',
                  font: { size: 16, weight: 'bold' }
                }
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    return context.label + ': ' + context.formattedValue;
                  }
                }
              }
            },
            scales: {
              r: {
                angleLines: { display: false },
                grid: { color: '#eee' },
                pointLabels: { font: { size: 16, weight: 'bold' }, color: '#222' },
                ticks: { color: '#222', font: { size: 14 } }
              }
            }
          }
        });
      }
    });
    {% endif %}
    
    // Charts for Hiring Success Rate Analytics (only for hiring_success_rate)
    {% if label|lower == 'hiring_success_rate' %}
    window.addEventListener('DOMContentLoaded', function() {
      // Set global allCandidates for this page
      allCandidates = {{ candidates_json|safe }};
      
      // Success Rate Breakdown Chart (Doughnut)
      const successRateData = [
        Number({{ total_hired|default(0) }}),
        Number({{ total_applicants|default(0) }}) - Number({{ total_hired|default(0) }})
      ];
      const successRateLabels = ['Hired', 'Not Hired'];
      const successRateColors = [
        'rgba(67, 160, 71, 0.8)',
        'rgba(244, 67, 54, 0.8)'
      ];
      const successRateBorderColors = [
        '#43a047',
        '#f44336'
      ];
      const successRateCanvas = document.getElementById('successRateChart');
      if (successRateCanvas) {
        const successRateCtx = successRateCanvas.getContext('2d');
        new Chart(successRateCtx, {
          type: 'doughnut',
          data: {
            labels: successRateLabels,
            datasets: [{
              data: successRateData,
              backgroundColor: successRateColors,
              borderColor: successRateBorderColors,
              borderWidth: 3
            }]
          },
          options: {
            responsive: false,
            plugins: {
              legend: {
                display: true,
                position: 'bottom',
                labels: {
                  color: '#222',
                  font: { size: 14, weight: 'bold' }
                }
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    const percentage = (context.parsed / successRateData.reduce((a, b) => a + b, 0) * 100).toFixed(1);
                    return context.label + ': ' + context.parsed + ' (' + percentage + '%)';
                  }
                }
              }
            }
          }
        });
      }
      
      // Department-wise Success Rate Chart (Radar)
      const deptLabels = {{ dept_labels_json|safe }};
      const deptCounts = {{ dept_counts_json|safe }};
      
      // Assign the candidates data to the global variable
      allCandidates = {{ candidates_json|safe }};
      
      console.log('Hiring Success Rate Chart Data:');
      console.log('deptLabels:', deptLabels);
      console.log('deptCounts:', deptCounts);
      console.log('allCandidates length:', allCandidates.length);
      console.log('Sample candidates:', allCandidates.slice(0, 3));
      
      const deptSuccessCanvas = document.getElementById('deptSuccessChart');
      let deptSuccessChart = null;
      if (deptSuccessCanvas && deptLabels.length && deptCounts.length) {
        const deptSuccessCtx = deptSuccessCanvas.getContext('2d');
        deptSuccessChart = new Chart(deptSuccessCtx, {
          type: 'radar',
          data: {
            labels: deptLabels,
            datasets: [{
              label: 'Success Rate by Department',
              data: deptCounts,
              fill: true,
              backgroundColor: 'rgba(156, 39, 176, 0.15)',
              borderColor: '#9c27b0',
              pointBackgroundColor: '#9c27b0',
              pointBorderColor: '#fff',
              pointHoverBackgroundColor: '#fff',
              pointHoverBorderColor: '#9c27b0'
            }]
          },
          options: {
            plugins: { legend: { display: false }, title: { display: false } },
            scales: {
              r: {
                angleLines: { display: true },
                suggestedMin: 0,
                suggestedMax: Math.max(...deptCounts, 5),
                pointLabels: { font: { size: 13, weight: '600' } }
              }
            },
            onClick: (e) => {
              console.log('Chart clicked!');
              const points = deptSuccessChart.getElementsAtEventForMode(e, 'nearest', { intersect: true }, true);
              console.log('Points found:', points.length);
              if (points.length) {
                const idx = points[0].index;
                console.log('Clicked index:', idx, 'Department:', deptLabels[idx]);
                showDeptApplicants(deptLabels[idx]);
              }
            }
          }
        });
        console.log('Chart created successfully');
      } else {
        console.log('Chart not created - missing data or canvas');
        console.log('Canvas exists:', !!deptSuccessCanvas);
        console.log('Labels length:', deptLabels.length);
        console.log('Counts length:', deptCounts.length);
      }
    });
    {% endif %}
    
    // Doughnut chart for Vacancy Status Breakdown (only for total_vacancies)
    {% if label|lower == 'total_vacancies' %}
    window.addEventListener('DOMContentLoaded', function() {
      const vacancyData = [
        Number({{ open_vacancies|default(0) }}),
        Number({{ closed_vacancies|default(0) }})
      ];
      const vacancyLabels = ['Open', 'Closed'];
      const vacancyColors = [
        'rgba(67, 160, 71, 0.8)',
        'rgba(244, 67, 54, 0.8)'
      ];
      const vacancyBorderColors = [
        '#43a047',
        '#f44336'
      ];
      const vacancyCanvas = document.getElementById('vacancyStatusChart');
      if (vacancyCanvas) {
        const vacancyCtx = vacancyCanvas.getContext('2d');
        new Chart(vacancyCtx, {
          type: 'doughnut',
          data: {
            labels: vacancyLabels,
            datasets: [{
              data: vacancyData,
              backgroundColor: vacancyColors,
              borderColor: vacancyBorderColors,
              borderWidth: 2
            }]
          },
          options: {
            responsive: false,
            plugins: {
              legend: {
                display: true,
                position: 'bottom',
                labels: {
                  color: '#222',
                  font: { size: 14, weight: 'bold' }
                }
              },
              tooltip: {
                callbacks: {
                  label: function(context) {
                    return context.label + ': ' + context.formattedValue;
                  }
                }
              }
            }
          }
        });
      }
    });
    {% endif %}
    // Department Radar Chart (for pages other than hiring_success_rate)
    {% if label|lower not in ['hiring_success_rate'] %}
    const generalDeptLabels = {{ dept_labels_json|safe }};
    const generalDeptCounts = {{ dept_counts_json|safe }};
    const allCandidates = {{ candidates_json|safe }};
    const radarCanvas = document.getElementById('deptRadarChart');
    let radarChart = null;
    if (radarCanvas && generalDeptLabels.length && generalDeptCounts.length) {
      radarChart = new Chart(radarCanvas.getContext('2d'), {
        type: 'radar',
        data: {
          labels: generalDeptLabels,
          datasets: [{
            label: 'Applicants',
            data: generalDeptCounts,
            fill: true,
            backgroundColor: 'rgba(25, 118, 210, 0.15)',
            borderColor: '#1976d2',
            pointBackgroundColor: '#1976d2',
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: '#1976d2'
          }]
        },
        options: {
          plugins: { legend: { display: false }, title: { display: false } },
          scales: {
            r: {
              angleLines: { display: true },
              suggestedMin: 0,
              suggestedMax: Math.max(...generalDeptCounts, 5),
              pointLabels: { font: { size: 13, weight: '600' } }
            }
          },
          onClick: (e) => {
            const points = radarChart.getElementsAtEventForMode(e, 'nearest', { intersect: true }, true);
            if (points.length) {
              const idx = points[0].index;
              showDeptApplicants(generalDeptLabels[idx]);
            }
          }
        }
      });
    }
    {% endif %}
    function showDeptApplicants(dept) {
      console.log('showDeptApplicants called with dept:', dept);
      console.log('allCandidates available:', typeof allCandidates !== 'undefined');
      console.log('allCandidates length:', typeof allCandidates !== 'undefined' ? allCandidates.length : 'undefined');
      
      const wrapper = document.getElementById('deptApplicantsTableWrapper');
      const title = document.getElementById('deptApplicantsTitle');
      const tbody = document.getElementById('deptApplicantsTable').querySelector('tbody');
      
      // Check if this is total_vacancies page
      const isVacancies = '{{ label|lower }}' === 'total_vacancies';
      const isHiringSuccess = '{{ label|lower }}' === 'hiring_success_rate';
      
      console.log('Page type - isVacancies:', isVacancies, 'isHiringSuccess:', isHiringSuccess);
      
      if (isVacancies) {
        title.textContent = `Jobs in "${dept}"`;
        tbody.innerHTML = '';
        const filtered = allCandidates.filter(c => (c.department || 'Unknown') === dept);
        console.log('Vacancies filtered:', filtered.length);
        if (filtered.length === 0) {
          tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:#888;">No jobs in this department.</td></tr>';
        } else {
          for (const job of filtered) {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td style='padding:6px 4px;'>${job.job_title}</td><td style='padding:6px 4px;'>${job.department}</td><td style='padding:6px 4px;'>${job.status}</td><td style='padding:6px 4px;'>${job.applied_date}</td><td style='padding:6px 4px;'>${job.openings}</td>`;
            tbody.appendChild(tr);
          }
        }
      } else {
        if (isHiringSuccess) {
          title.textContent = `Hired Candidates in "${dept}"`;
          tbody.innerHTML = '';
          // For hiring success rate, filter for hired candidates only in the selected department
          const filtered = allCandidates.filter(c => 
            (c.department || 'Unknown') === dept && 
            (c.status || '').toLowerCase() === 'hired'
          );
          console.log('Hiring success filtered for dept:', dept, 'count:', filtered.length);
          console.log('Sample filtered candidates:', filtered.slice(0, 3));
          if (filtered.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:#888;">No hired candidates in this department.</td></tr>';
          } else {
            for (const cand of filtered) {
              const tr = document.createElement('tr');
              tr.innerHTML = `<td style='padding:6px 4px;'>${cand.name}</td><td style='padding:6px 4px;'>${cand.job_title}</td><td style='padding:6px 4px;'>${cand.status}</td><td style='padding:6px 4px;'>${cand.applied_date}</td><td style='padding:6px 4px;'><a class='btn btn-primary' style='padding:4px 12px;' href='/candidate/${cand.id}'>View Profile</a></td>`;
              tbody.appendChild(tr);
            }
          }
        } else {
          title.textContent = `Applicants in "${dept}"`;
          tbody.innerHTML = '';
          const filtered = allCandidates.filter(c => (c.department || 'Unknown') === dept);
          console.log('General applicants filtered:', filtered.length);
          if (filtered.length === 0) {
            tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:#888;">No applicants in this department.</td></tr>';
          } else {
            for (const cand of filtered) {
              const tr = document.createElement('tr');
              tr.innerHTML = `<td style='padding:6px 4px;'>${cand.name}</td><td style='padding:6px 4px;'>${cand.job_title}</td><td style='padding:6px 4px;'>${cand.status}</td><td style='padding:6px 4px;'>${cand.applied_date}</td><td style='padding:6px 4px;'><a class='btn btn-primary' style='padding:4px 12px;' href='/candidate/${cand.id}'>View Profile</a></td>`;
              tbody.appendChild(tr);
            }
          }
        }
      }
      wrapper.style.display = 'block';
      window.scrollTo({ top: wrapper.offsetTop - 80, behavior: 'smooth' });
    }
  </script>
  
  <!-- CSS for pace badges -->
  <style>
    .pace-excellent { background-color: #2e7d32 !important; }
    .pace-good { background-color: #43a047 !important; }
    .pace-adequate { background-color: #ff9800 !important; }
    .pace-inadequate { background-color: #f44336 !important; }
  </style>
  
  <!-- Initialize pace badge colors -->
  <script>
    window.addEventListener('DOMContentLoaded', function() {
      // Apply colors to pace badges
      const paceBadges = document.querySelectorAll('.pace-badge');
      paceBadges.forEach(badge => {
        const pace = badge.textContent.trim().toLowerCase();
        badge.classList.add('pace-' + pace);
      });
    });
  </script>
</div>
{% endblock %}
